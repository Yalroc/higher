<!-- 1. JOB OFFER -->
<div class="black-background tab-content" id="job-offer">
  <div class="container">
    <div class="row">
      <div class="col-xs-12 col-sm-8 col-sm-offset-2">
        <div class="cv-wrapper"> <!-- div englobbante  -->
          <% if  @job_offer %>
            <h4 class="text-center"><%= @job_offer.title + " @ " + @job_offer.recruiter.organization.name %></h4>
            <div class="job-offer-icons-div">
              <ul class="list-inline product-controls hidden-sm hidden-xs text-center">
                <li><i class="fa fa-globe"></i> <%= @job_offer.location %></li>
                <li><i class="fa fa-wpforms"></i> <%= @job_offer.min_xp.to_i.to_s + "y - " + @job_offer.max_xp.to_i.to_s + "y" %></li>
                <li><i class="fa fa-money"></i> <%= @job_offer.salary.to_s + "Kâ‚¬" %></li>
              </ul>
            </div>
            <p><%= simple_format @job_offer.description %></p>
          <% else %>
            <p>Sorry mate. This job offer does not have a description..</p>
          <% end %>
        </div> <!-- fin div englobbante  -->
      </div>
    </div>
  </div>
</div> <!-- fin couleur de fond black -->


<!-- 2. RESUME -->
<div class="gray-background tab-content" id="resume"> <!-- couleur de fond grise -->
  <div class="container">
    <div class="row">
      <div class="col-xs-12 col-sm-8 col-sm-offset-2">


        <div class="cv-wrapper"> <!-- div englobbante  -->

          <!-- experiences  -->
          <% if @experiences_sorted.empty? %>
          <% else %>
            <div class="">
              <h3><i class="fa fa-wpforms" aria-hidden="true"></i> EXPERIENCES</h3>
              <% @experiences_sorted.each do |experience| %>
                <div class="">
                  <h4 class="display-inline"><%= experience.title + " @ " + experience.organization %></h4>
                  <a href="" data-toggle="modal" data-target="#EditExperienceModal">Edit /</a>  <!-- button de modal: Add XP -->
                  <div class="modal fade" id="EditExperienceModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                    <div class="modal-dialog" role="document">  <!-- modal Edit Experience -->
                      <div class="modal-content">
                        <div class="modal-header">
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                          <h4 class="modal-title" id="myModalLabel">Edit Experience</h4>
                        </div>
                        <div class="modal-body">
                          <%= simple_form_for(experience) do |field| %>
                              <%= field.input :title %>
                              <%= field.input :organization %>
                              <%= field.input :start_date, discard_day: true, order: [:month, :year] %>
                              <%= field.input :end_date, discard_day: true, order: [:month, :year] %>
                              <%= field.input :present %>
                              <%= field.input :description %>
                              <%#=  field.input :company_size %>
                              <%#= field.input :industry %>
                              <%= field.input :job_application_id, as: :hidden, input_html: {value: @job_application.id} %>
                              <%= field.button :submit %>
                            <% end %>
                        </div>
                      </div>
                    </div>
                  </div>
                  <%= link_to "Delete", experience_path(experience), method: :delete %>
                  <p class="display-inline"><%= experience.start_date.month.to_s + "/" + experience.start_date.year.to_s + " - " + experience.end_date.month.to_s + "/" + experience.end_date.year.to_s + " >> " %>
                  <% if (((experience.end_date - experience.start_date)/30.5).to_i/12) != 0 %>
                    <%=  (((experience.end_date - experience.start_date)/30.5).to_i/12).to_s + " year(s) " %>
                  <% end %>
                  <% if (((experience.end_date - experience.start_date)/30.5).to_i%12) != 0 %>
                    <%= (((experience.end_date - experience.start_date)/30.5).to_i%12).to_s + " month(s)" %><p>
                  <% end %>
                  <p><%= experience.description %></p>
                </div>
              <% end %>
            </div>
          <% end %>
          <a href="" data-toggle="modal" data-target="#AddExperienceModal">Add Experience</a> <!-- button de modal: Add XP -->
          <div class="modal fade" id="AddExperienceModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">  <!-- modal Add Experience -->
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                  <h4 class="modal-title" id="myModalLabel">Add Experience</h4>
                </div>
                <div class="modal-body">
                  <%= simple_form_for(@experience) do |field| %>
                      <%= field.input :title %>
                      <%= field.input :organization %>
                      <%= field.input :start_date, discard_day: true, order: [:month, :year] %>
                      <%= field.input :end_date, discard_day: true, order: [:month, :year] %>
                      <%= field.input :present %>
                      <%= field.input :description %>
                      <%#= field.input :company_size %>
                      <%#= field.input :industry %>
                      <%= field.input :job_application_id, as: :hidden, input_html: {value: @job_application.id} %>
                      <%= field.button :submit %>
                    <% end %>
                </div>
              </div>
            </div>
          </div> <!-- fin de experiences -->

          <!-- educations -->
          <% if @educations_sorted.empty? %>
          <% else %>
            <div class="">
              <h3><i class="fa fa-graduation-cap" aria-hidden="true"></i> EDUCATION</h3>
              <% @educations_sorted.each do |education| %>
                <div class="">
                  <h4 class="display-inline"><%= education.degree_type + ' ' + education.degree_field + ' @ ' + education.organization %></h4>
                  <a href="" data-toggle="modal" data-target="#EditEducationModal">Edit /</a>   <!-- button de modal: Edit Education -->
                  <div class="modal fade" id="EditEducationModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"> <!-- modal Edit Education -->
                    <div class="modal-dialog" role="document">
                      <div class="modal-content">
                        <div class="modal-header">
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                          <h4 class="modal-title" id="myModalLabel">Edit Experience</h4>
                        </div>
                        <div class="modal-body">
                          <%= simple_form_for(education) do |field| %>
                            <%= field.input :degree_type %>
                            <%= field.input :degree_field %>
                            <%= field.input :organization %>
                            <%= field.input :start_date, discard_day: true, discard_month: true %>
                            <%= field.input :end_date, discard_day: true, discard_month: true %>
                            <%= field.input :description %>
                            <%= field.input :job_application_id, as: :hidden, input_html: {value: @job_application.id} %>
                            <%= field.button :submit %>
                          <% end %>
                        </div>
                      </div>
                    </div>
                  </div>  <!-- end of modal -->
                  <%= link_to "Delete", education_path(education), method: :delete %>
                  <p><%= education.start_date.year.to_s + " - " + education.end_date.year.to_s + " >> " + ([(education.end_date.year - education.start_date.year), 1].max ).to_s + " year(s)" %><p>
                  <p><%= education.description %></p>
                </div>
              <% end %>
            </div>
          <% end %>
          <a href="" data-toggle="modal" data-target="#AddEducationModal">Add Education</a> <!-- button de modal: Add Education -->
          <div class="modal fade" id="AddEducationModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"> <!-- modal Add Education-->
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                  <h4 class="modal-title" id="myModalLabel">Add Education</h4>
                </div>
                <div class="modal-body">
                  <%= simple_form_for(@education) do |field| %>
                    <%= field.input :degree_type %>
                    <%= field.input :degree_field %>
                    <%= field.input :organization %>
                    <%= field.input :start_date, discard_day: true, discard_month: true %>
                    <%= field.input :end_date, discard_day: true, discard_month: true %>
                    <%= field.input :description %>
                    <%= field.input :job_application_id, as: :hidden, input_html: {value: @job_application.id} %>
                    <%= field.button :submit %>
                  <% end %>
                </div>
              </div>
            </div>
          </div> <!-- fin de educations -->

          <!-- Languages -->
          <% if @languages.empty? %>
          <% else %>
            <div class="">
              <h3><i class="fa fa-globe" aria-hidden="true"></i> LANGUAGES</h3>
              <ul><% @languages.each do |language| %>
                  <li><%= language.name + ' >> ' + language.proficiency %>
                  <a href="" data-toggle="modal" data-target="#EditLanguageModal">Edit /</a> <!-- button de modal: Edit Education -->
                  <div class="modal fade" id="EditLanguageModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"> <!-- modal Edit Education -->
                    <div class="modal-dialog" role="document">
                      <div class="modal-content">
                        <div class="modal-header">
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                          <h4 class="modal-title" id="myModalLabel">Edit Language</h4>
                        </div>
                        <div class="modal-body">
                          <%= simple_form_for(language) do |field| %>
                            <%= field.input :name %>
                            <%= field.input :proficiency %>
                            <%= field.input :job_application_id, as: :hidden, input_html: {value: @job_application.id} %>
                            <%= field.button :submit %>
                          <% end %>
                        </div>
                      </div>
                    </div>
                  </div>
                  <%= link_to "Delete", language_path(language), method: :delete %>
                  </li>
              <% end %>
              </ul>
            </div>
          <% end %>
          <a href="" data-toggle="modal" data-target="#AddLanguageModal">Add Language</a> <!-- button de modal: Add Language -->
          <div class="modal fade" id="AddLanguageModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"> <!-- modal Add Language -->
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                  <h4 class="modal-title" id="myModalLabel">Add Language</h4>
                </div>
                <div class="modal-body">
                  <%= simple_form_for(@language) do |field| %>
                    <%= field.input :name %>
                    <%= field.input :proficiency %>
                    <%= field.input :job_application_id, as: :hidden, input_html: {value: @job_application.id} %>
                    <%= field.button :submit %>
                  <% end %>
                </div>
              </div>
            </div>
          </div> <!-- fin languages -->

        </div> <!-- fin div englobbante du cv  -->
      </div> <!-- col de bootstrap -->
    </div> <!-- row de bootstrap -->
  </div> <!-- container de bootstrap -->
</div> <!-- fin couleur de fond grise -->


<!-- 3. MOTIVATION LETTER -->
<div class="gray-background tab-content" id="cover-letter">
  <div class="container">
    <div class="row">
      <div class="col-xs-12 col-sm-8 col-sm-offset-2">
        <div class="cv-wrapper"> <!-- div englobbante -->
          <%= simple_form_for([@job_offer, @job_application]) do |field| %>
            <%= field.input :motivation_letter, input_html: { id: 'motivation_letter_field', placeholder: @sample_letter } %>
            <%= field.button :submit, "Save", class: "btn btn-primary" %>
          <% end %>
        </div> <!-- fin div englobbante  -->
      </div>
    </div>
  </div>
</div> <!-- fin couleur de fond grise -->


<!-- ++ VIEW AS EMPLOYER MODAL -->
<div class="modal fade" id="ViewAsEmployerModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <button type="button" class="close top-right" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">

        <!-- experience  -->
        <% if @experiences_sorted.empty? %>
        <% else %>
          <div class="">
            <h5><i class="fa fa-wpforms" aria-hidden="true"></i> EXPERIENCES</h5>
            <% @experiences_sorted.each do |experience| %>
              <div class="">
                <h6 class="display-inline"><%= experience.title + " @ " + experience.organization %></h6>
                <p class="display-inline small-text"><%= experience.start_date.month.to_s + "/" + experience.start_date.year.to_s + " - " + experience.end_date.month.to_s + "/" + experience.end_date.year.to_s + " >> " %>
                <% if (((experience.end_date - experience.start_date)/30.5).to_i/12) != 0 %>
                  <%=  (((experience.end_date - experience.start_date)/30.5).to_i/12).to_s + " year(s) " %>
                <% end %>
                <% if (((experience.end_date - experience.start_date)/30.5).to_i%12) != 0 %>
                  <%= (((experience.end_date - experience.start_date)/30.5).to_i%12).to_s + " month(s)" %><p>
                <% end %>
                <p class="small-text"><%= experience.description %></p>
              </div>
            <% end %>
          </div>
        <% end %> <!-- fin de experiences -->

        <!-- education -->
        <% if @educations_sorted.empty? %>
        <% else %>
          <div class="">
            <h5><i class="fa fa-graduation-cap" aria-hidden="true"></i> EDUCATION</h5>
            <% @educations_sorted.each do |education| %>
              <div class="">
                <h6 class="display-inline"><%= education.degree_type + ' ' + education.degree_field + ' @ ' + education.organization %></h6>
                <p class="small-text"><%= education.start_date.year.to_s + " - " + education.end_date.year.to_s + " >> " + ([(education.end_date.year - education.start_date.year), 1].max ).to_s + " year(s)" %><p>
                <p class="small-text"><%= education.description %></p>
              </div>
            <% end %>
          </div>
        <% end %> <!-- fin de educations -->

        <!-- languages -->
        <% if @languages.empty? %>
        <% else %>
          <div class="">
            <h5><i class="fa fa-globe" aria-hidden="true"></i> LANGUAGES</h5>
            <ul><% @languages.each do |language| %>
                <li class="small-text">
                  <%= language.name + ' >> ' + language.proficiency %>
                </li>
            <% end %>
            </ul>
          </div>
        <% end %> <!-- fin languages -->


        <!-- motivation letter -->
        <div class="top-border">
          <h5><i class="fa fa-pencil" aria-hidden="true"></i> COVER LETTER</h5>
          <p class="small-text"><%= simple_format @job_application.motivation_letter %></p>
        </div>
        <!-- footer de modal -->
        <div class="modal-footer view-as-modal-footer">
          <button type="button" class="btn btn-default btn-submit-application" data-dismiss="modal"><i class="fa fa-undo" aria-hidden="true"></i> Return</button>
          <%= button_to "Submit Application", submit_job_offer_job_application_path(@job_offer, @job_application), class: "btn btn-primary btn-return-to-funnel" %>
        </div>

      </div> <!-- fin div englobbante du cv  -->
    </div>
  </div>
</div>  <!-- fin de la modal -->
